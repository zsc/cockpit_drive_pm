# Chapter 13｜项目计划与时间控制节点（Gates）

## 1. 开篇段落

在驾舱一体（Driving-Cabin Integration）项目中，项目管理的本质是**管理不确定性**。我们试图将“概率性的生成式AI（座舱LLM）”与“确定性的安全系统（自动驾驶E2E）”融合，同时还要协调“敏捷迭代的软件应用”与“严谨漫长的整车V模型开发”两种截然不同的研发节奏。

如果缺乏强有力的时间控制和门径管理（Gate Keeping），项目极易陷入“永远在联调，永远有Bug”的泥潭。本章将为 TPM 和 PM 提供一套经实战验证的**双模态项目管理框**。我们将详细拆解从概念到量产的六个阶段（P0-P5），定义六个严苛的质量门（Gates），并重点阐述在关键集成点如何通过“冻结策略”和“Cut Line（裁剪线）”来确保交付。

**本章目标**：
*   建立适配“自驾+大模型”特征的混合开发生命周期。
*   明确每个 Gate 的**准入（Entry）**与**准出（Exit）**铁律。
*   掌握处理跨团队依赖与集成风险的实操工具。

## 2. 核心论述

### 13.1 项目分期方法：双流并进与“齿轮咬合”

传统的瀑布流太慢，纯粹的敏捷流对汽车太危险。我们采用 **“主干门径（Stage-Gate）+ 分支敏捷（Scrum/Kanban）”** 的混合模式。

*   **座舱流 (Cabin Stream)**：以 2 周为 Sprint，快速迭代 Prompt、ASR 模型优化、UI 交互。特点是**快**。
*   **自驾流 (AD Stream)**：以数据闭环为周期（通常 4-6 周），涉及模型训练、仿真回归、实车验证。特点是**稳**。
*   **集成合点 (Sync Points)**：这是项目管理的“心跳”。不管分支跑多快，必须在咬合点强制同步。

```ascii
Timeline: Start ------------------------------------------------------------------------> SOP
Phase:    [ P0 探索 ]  [ P1 方案 ]  [ P2 原型 ]    [ P3 集成 ]    [ P4 试点 ]    [ P5 量产 ]
           (2 months)   (1 month)    (2 months)     (3 months)     (2 months)     (Ongoing)

Gate:     <G-A>        <G-B>        <G-C>          <G-D>          <G-E>          <G-F>
            |            |            |              |              |              |
AD Stream:  |--Feasibility-|--Arch/Sim--|--Model Trn---|--Road Test---|--Cert/Fix----|
            |            |            |              |              |              |
Cabin Stream:|-Prompt POC--|--Dev/UI----|--Agent Dev---|--Stability---|--Ops/Grey----|
            |            |            |              |              |              |
Key Actions:| MRD/Tech   | API Freeze | Happy Path   | Corner Case  | Metrics      | Launch
            | Review     | & Safety   | Demo         | & Bug Bash   | Sign-off     |
```

### 13.2 阶段详细定义 (Phase Deep Dive)

每个阶段必须有明确的“战役目标”。

#### 13.2.1 P0 探索：需求与可行性 (Discovery)
*   **目标**：回答“能不能做”和“值不值得做”。
*   **核心活动**：
    *   **自驾侧**：评估现有 E2E 模型是否支持通过 API 注入导航指令？时延多少？
    *   **座舱侧**：LLM 选型（云端 vs 端侧），测试 Intent 识别准确率基线。
    *   **产品侧**：定义“对话导航”的核心场景（如：模糊地点的多轮确认）。
*   **关键产出**：可行性分析报告（T-Feasibility Report）、MRD。

#### 13.2.2 P1 方案：架构与契约 (Planning & Contract)
*   **目标**：**锁定接口**。这是最重要的阶段，省什么时间都不能省这里的时间。
*   **核心活动**：
    *   制定 **IDL (Interface Definition Language)**：定义座舱 Agent 传给自驾 JSON Schema（如 `{ "action": "navigate", "target": {"lat":..., "lon":...}, "confirm_status": "confirmed" }`）。
    *   **HARA (危害分析与风险评估)**：如果 LLM 传错了坐标，车会不会乱开？设计安全围栏（Safety Guard）。
*   **关键产出**：PRD 冻结版、架构设计文档 (ADD)、接口控制文档 (ICD)、测试策略。

#### 13.2.3 P2 原型：端到端连通 (Prototyping)
*   **目标**：跑通主流程（Happy Path）。
*   **核心活动**：
    *   **Mock 开发**：座舱团队用自驾 Mock Server 开发；自驾团队用脚本模拟指令开发。
    *   **台架集成 (Bench)**：在实验室台架上，通过真实语音输入，驱动仿真环境中的车辆规划路线。
*   **关键产出**：可演示的 Demo（允许有 Bug，但核心链路必须通）。

#### 13.2.4 P3 集成：回归与覆盖 (Integration & Regression)
*   **目标**：发现 Bug，覆盖长尾。这是“集成地狱”阶段。
*   **核心活动**：
    *   **实车路测**：每天上路，收集真实噪音环境下的语音和真实路况下的执行表现。
    *   **Bad Case 挖掘**：专门测试“刁钻”场景（如：快速连续改目的地、弱网环境）。
    *   **性能优化**：死磕端到端时延（Target: < 1.5s）。
*   **关键产出**：Alpha 版本（功能 Feature Complete）。

#### 13.2.5 P4 试点：指标与稳定性 (Pilot/Beta)
*   **目标**：验证统计学指标。
*   **核心活动**：
    *   **内部灰度**：发放给员工车队（100+台）。
    *   **A/B Test**：对比不同 Prompt 或确认策略的转化率。
    *   **压力测试**：连续运行 48 小时无 Crash。
*   **关键产出**：Beta/RC 版本，验收报告。

#### 13.2.6 P5 量产：SOP 与运营 (Launch)
*   **目标**：安全发布。
*   **核心活动**：OTA 包构建、说明书更新、客服话术培训、监控看板上线。

---

### 13.3 Gate 设计：六道“鬼门关”

Gate 评审不是汇报会，而是**审判庭**。评审通常由各域 Tech Lead、质量负责人、安全负责人组成。

#### 13.3.1 Gate A: 立项与范围冻结 (Concept Freeze)
*   **Entry**: MRD 完成，核心技术预研 Demo（POC）完成。
*   **Exit Criteria**:
    1.  **范围清单 (Scope List)** 签字确认：明确哪些做（In-Scope），哪些不做（Out-Scope）。
    2.  **资源锁定**：测试车（比如 5 台）、GPU 算力、标注预算已批复。
    3.  **北极星指标** 定义完成（如：语音导航任务达成率 > 90%）。
*   **Risk**: 需求过于模糊，导致后期无休止变更。

#### 13.3.2 Gate B: 架构与接口冻结 (Design Freeze)
*   **Entry**: 概要设计完成，安全分析完成。
*   **Exit Criteria**:
    1.  **接口冻结 (API Freeze)**：自驾与座舱的通信协议文档版本号锁定。此后任何修改必须走变更委员会 (CCB)。
    2.  **安全评审通过**：确认机制、降级策略（Fallback）已定义并获安全团队认可。
    3.  **测试用例 (Test Cases)** 评审通过：QA 知道该怎么测了。

#### 13.3.3 Gate C: 核心场景 MVP (Feature Complete)
*   **Entry**: 所有 P0 功能代码开发完成，台架测试通过。
*   **Exit Criteria**:
    1.  **Happy Path 100% 通过**：在实车静止状态下，语音导航全流程无阻碍。
    2.  **无 P0 级 Bug**：没有 Crash，没有严重逻辑错误。
    3.  **时延达标**：首字上屏时间、指令下发时延满足基线要求。
*   **Kill Criteria**: 如果此时核心链路仍需 Mock 数据才能跑通，**项目红灯**，立即暂停后续开发，集中攻关。

#### 13.3.4 Gate D: 集成回归通过 (Code Freeze)
*   **Entry**: 功能全量集成，P1/P2 Bug 修复率 > 80%。
*   **Exit Criteria**:
    1.  **代码冻结**：主分支封板，只允许 Cherry-pick 修复严重 Bug。
    2.  **稳定性达标**：MTBF (平均故障间隔时间) > 200 小时。
    3.  **降级演练通过**：模拟断网、地图服务挂掉、LLM 乱语，系统能安全兜底（如切传统导航或拒绝执行）。

#### 13.3.5 Gate E: 试点指标达标 (Release Candidate)
*   **Entry**: 内部车队路测里程 > 10,000 km。
*   **Exit Criteria**:
    1.  **指标达成**：任务完成率、误触发率达到 SOP 标准。
    2.  **零严重安全隐患**：所有 High Severity 的安全 Ticket 必须 Close。
    3.  **回滚验证**：验证 OTA 失败后的自动回滚机制有效。

#### 13.3.6 Gate F: 量产发布评审 (SOP)
*   **Entry**: 灰度测试无重大客诉。
*   **Exit Criteria**:
    1.  **全量包 Ready**。
    2.  **合规签署**：法务确认隐私条款、地图测绘合规、数据出境合规。
    3.  **运营就绪**：FAQ、用户手册、宣传物料已发布。

---

### 13.4 关键路径与依赖 (Critical Path & Dependencies)

TPM 需重点监控以下“卡脖子”环节：

1.  **地图 SDK 版本**：
    *   座舱用的地图渲染 SDK 和自驾用的高精地图/SD Pro 地图数据必须**同源或坐标系对齐**。地图版本的新往往滞后，需提前 2 个月锁定。
2.  **自驾 E2E 模型冻结**：
    *   模型训练周期长（采集->清洗->训练->验证需 4-6 周）。座舱的语音指令必须适配**特定版本**的模型能力。如果模型换了，座舱的 Prompt 策略可能要重调。
3.  **实车资源 (Mules/VP Cars)**：
    *   带有最新传感器和算力板子的车通常极少。需提前 1 个月预订路测时间窗。
4.  **第三方服务集成**：
    *   大模型云服务、云端语音识别、POI 搜索服务的 SLA 和接口变更。

---

### 13.5 风险缓冲与 Cut Line (砍需求策略)

**Rule of Thumb**: 在 Gate C 和 Gate D 之间预留 **20% 的时间缓冲 (Buffer)**。

**Cut Line 策略**（如果进度延期，按以下顺序砍）：
1.  **L3: 锦上添花体验**（砍）：例如“根据天气推荐餐厅”、“复杂的上下文多轮闲聊”。
2.  **L2: 辅助功能**（砍）：例如“途经点智能排序”、“语音修改偏好设置”。
3.  **L1: 心体验**（保）：例如“模糊地点确认”、“途中修改目的地”。
4.  **L0: 安全底线**（死保）：例如“指令确认机制”、“权限校验”、“随时可撤销”。

---

### 13.6 进度管理可视化

推荐使用 **集成成熟度矩阵 (Integration Maturity Matrix)** 代替简单的百分比。

| 模块 | 接口定义 | Mock 联调 | 台架通过 | 实车静态 | 实车动态 | 压力测试 |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: |
| 语音识别 | ✅ | ✅ | ✅ | ✅ | ✅ | 🟡 |
| 意图理解(LLM) | ✅ | ✅ | ✅ | ✅ | 🟡 | 🔴 |
| 导航引擎 | ✅ | ✅ | ✅ | 🟡 | ⚪️ | ⚪️ |
| 自驾规划(Planner) | ✅ | ✅ | 🟡 | ⚪️ | ⚪️ | ⚪️ |

*(图例：✅完成，🟡进行中/有风险，🔴阻塞/延期，⚪️未开始)*

---

## 3. 本章小结

*   **双流合一**：PM 必须理解座舱的“快”和自驾的“慢”，利用 Gate 强制同步，避免“快马被慢车绊倒”或“慢车被快马偏”。
*   **接口即法律**：Gate B 的接口冻结是项目成败的分水岭。前期定义的 Schema 越严谨，后期的集成痛苦越少。
*   **数据说话**：从 Gate C 开始，不要听“我觉得通了”，要看“路测日志”和“埋点数据”。
*   **安全一票否决**：无论进度多紧，只要 Gate D 的降级演练不通过，或者 HARA 风险未闭环，绝不发布。

---

## 4. 练习题

### 基础题 (50%)

**Q1. (单选) 在驾舱一体项目中，关于“代码冻结 (Code Freeze)”通常发生在哪个阶段？**
A. Gate B (设计冻结)
B. Gate C (MVP)
C. Gate D (集成回归)
D. Gate F (SOP)

<details>
<summary>点击查看答案与提示</summary>

**答案：** C (Gate D)
**提示：** 代码冻结是为了进行最后的稳定性测试和压测。如果在 SOP (Gate F) 才冻结就太晚了，根本没时间测稳定性。Gate B 冻结的是接口和设计，不是代码实现。
</details>

**Q2. (多选) 以下哪些是 Gate B (架构与接口结) 必须包含的交付物？**
A. 完整的 UI 高保真设计图
B. 自驾与座舱的接口定义文档 (IDL/ICD)
C. 最终的用户使用手册
D. 危害分析与风险评估 (HARA) 报告

<details>
<summary>点击查看答案与提示</summary>

**答案：** B, D
**提示：** 接口定义是 Gate B 的核心；HARA 决定了安全架构，必须在开发前完成。UI 设计图通常在 Gate B 前完成，但在 Gate B 必须冻结关键交互逻辑。用户手册是 Gate F 的产物。
</details>

**Q3. (填空) 在项目时间轴上，为了应对跨团队集成的不可预见性，通常在 _______ 阶段和 _______ 阶段之间预留 Buffer（缓冲期），这被称为“集成地狱”时期。**

<details>
<summary>点击查看答案与提示</summary>

**答案：** Gate C (MVP/Feature Complete)；Gate D (Code Freeze)
**提示：** 从“功能跑通”到“系统稳定”是 Bug 最密集、扯皮最多的时期。
</details>

**Q4. (简答) 什么是“Cut Line”？请结合对话导航项目举例说明。**

<details>
<summary>点击查看答案与提示</summary>

**答案：**
Cut Line 是在项目进度受阻或风险过高时，预先定义的“功能裁剪线”。
**举例：** 在对话导航项目中，如果在 Gate D 前性能不达标，我们可以依据 Cut Line 砍掉“多轮复杂闲聊”或“根据心情推荐路线”等 P2 功能，但必须保留“精准导航”、“确认弹窗”等 P0 功能，以确保核心价值交付。
</details>

---

### 挑战题 (50%)

**Q5. (情景题：死锁打破) 项目进入 Gate C (MVP) 前夕，座舱团队声称：“我们已经按接口文档发出了 JSON 指令，是自驾团队不执行。” 自驾团队声称：“我们没收到合法的指令，是座舱发的数据格式不对。” 双方互相推诿，导致进度停滞 3 天。作为 TPM，你该如何打破这个死锁？**

<details>
<summary>点击查看答案与提示</summary>

**参考答案：**
1.  **召开“现场抓包会” (War Room)**：立即两边 Tech Lead 拉到一个房间，禁止口头争论。
2.  **工具介入**：使用抓包工具（如 Wireshark, tcpdump 或中间件自带的 Trace 工具）在通信总线（DDS/SOMEIP）上截取真实数据包。
3.  **对照 ICD**：将抓到的数据包与 Gate B 冻结的接口文档（ICD）逐字段比对。
    *   如果是数据发出了但格式错 -> 座舱修。
    *   如果是格式对但没收到/没反应 -> 自驾修或中间件问题。
4.  **建立自动化校验**：以此为契机，强制要求在接口层增加“Schema 校验拦截器”，数据不合规直接报错并记录日志，避免未来扯皮。
**提示：** 在集成阶段，日志和抓包数据是唯一的真理。
</details>

**Q6. (风险决策) 在 Gate E (试点) 阶段，由于地图供应商数据更新，导致“去公司”这一指令在 1% 的情况下会导航到公司后门的封闭道路。修复需要地图方发版（需 1 个月），或者自驾端更新 E2E 模型（需 3 周）。SOP 就 2 周后。请制定决策方案。**

<details>
<summary>点击查看答案与提示</summary>

**参考答案：**
这是一个“带病上线”还是“延期”的决策。
1.  **评估严重度**：导航到封闭道路属于体验缺陷（Medium/Low），只要车辆能识别封闭道路并停车/掉头，不属于严重安全事故（Safety Critical）。
2.  **短期规避 (Workaround)**：
    *   **座舱层拦截**：如果该封闭道路坐标已知，可以在座舱云端或端侧建立“黑名单围栏”，当规划终点落在此区域时，强制引导至正门坐标。这通常只需要配置更新（1-2天）。
3.  **决策**：
    *   采用座舱层 Workaround 方案。
    *   按期 SOP。
    *   在 Release Note 中不需提及，但客服需知晓。
    *   推动地图方和自驾方在 SOP+1 版本修复根因。
**提示：** 软件工程中，“硬编码（Hardcode）”或“配置补丁”虽然不优雅，却是保交付的重要手段。
</details>

**Q7. (流程化) 团队发现每次 Gate 评审都变成了“批斗大会”，耗时 4 小时且结论模糊。请重新设计 Gate D (Code Freeze) 的评审流程，使其高效且有效。**

<details>
<summary>点击查看答案与提示</summary>

**参考答案：**
1.  **预评审 (Pre-Meeting)**：所有测试报告、Bug 统计、测试视频必须在会议前 24 小时发出。所有评审人必须在会前阅读并填写“关注点”。
2.  **看板驱动**：会议不投 PPT，直接投 Jira/Bug 看板。只看 P0/P1 Bug 清零情况和稳定性测试曲线。
3.  **只做判断题**：会议只讨论“不符合准出标准”的项。
    *   “这个 Bug 为什么没修？” -> “风险可控吗？” -> “Accept 还是 Block？”
4.  **结论明确**：会议结束只有三个结果：
    *   **Go**：通过。
    *   **Conditional Go**：有条件通过（如：24小时内修复某具体问题，无需复会）。
    *   **No-Go**：打回，修好后重新约会。
**提示：** Gate 会是用来做决定的，不是用来汇报工作的。
</details>

**Q8. (开放思考) 你的项目采用了端云结合架构。云端大模型迭代极快（每周一更），而车端软件需要严格的 OTA 周期（3个月）。如何设计版本管理策略，使得云端的新能力（如新学的流行语、新的意图分类）能安全地作用于老版本的车端？**

<details>
<summary>点击查看答案与提示</summary>

**参考答案：**
需要设计 **“能力协商”与“向下兼容”** 机制。
1.  **功能标志位 (Feature Flags)**：车端上传状态包含 `supported_features: ["nav_v1", "music_v2"]`。
2.  **云端适配层**：云端 LLM 输出虽新，但在下发指令前，经过一个“适配器（Adapter）”。
    *   如果车端支持新意图 -> 下发新指令。
    *   如果车端是老版本 -> 将新意图映射（Map）为老版本支持的最接近指令，或降级为纯文本回复。
3.  **配置驱动 UI**：车端的 UI 组件设计为由云端发的 JSON 驱动（Server-Driven UI）。云端下发新的卡片布局描述，老车端引擎渲染，从而实现不发 OTA 也能更新部分交互体验。
**提示：** 解耦是关键。云快端慢，中间必须有“变速箱”（适配层）。
</details>

---

## 5. 常见陷阱与错误 (Gotchas)

### 1. "差不多" 先生 (The "Good Enough" Trap)
*   **现象**：Gate C 时，PM 说“虽然这个确认弹窗有时候弹不出来，但只要用户说话标准点就行，先过吧”。
*   **后果**：这个“有时候”在 Gate D 压力测试下会变成“灾难”。**早期放过的小问题，后期是修不完的债。**
*   **对策**：Gate 标准必须是二进制的（0 或 1），没有“差不多”。

### 2. 用 PPT 代替 Demo，用 Demo 代替实车
*   **现象**：评审会上看了一段精美的视频，觉得做完了。实际上那是两周前录的，现在的代码根本跑不起来。或者只在台架上跑通了，没上过路。
*   **后果**：上车后现噪音、震动、网络波动让系统完全不可用。
*   **对策**：Gate C 之后的评审，**必须在实车上进行**，或者查看包含完整时间戳和环境信息的实车日志回放。

### 3. 忽视了 "运营侧" 的准备
*   **现象**：技术研发嗨皮地冲到了 Gate F，突然发现客服团队根本不知道怎么回答用户关于“大模型导航”的问题，说明书也没写“可能会有幻觉”。
*   **后果**：发布后立刻引发客诉危机，甚至因缺乏风险提示被监管约谈。
*   **对策**：P5 阶段必须将运营、法务、客服纳入核心项目组，他们的 Sign-off 和代码通过一样重要。

### 4. 只有 Plan A，没有 Plan B
*   **现象**：赌定自驾团队能在 SOP 前优化好 E2E 模型。结果没优化好。
*   **后果**：项目延期半年。
*   **对策**：在 Gate B 就必须设计好 **降级方案（Plan B）**。如果 E2E 不行，能不能回退到传统的 API 导航？如果 LLM 挂了，能不能回到规则引擎？**Plan B 是保命的降落伞。**
